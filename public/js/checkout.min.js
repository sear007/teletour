!function(e){"use strict";function t(e,t={}){let a=function e(t={}){return{method:"GET",responseType:"json",...t}}({...t,url:e,headers:function e({headers:t={}}){return{...t,"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}(t)});return axios(a).then(({data:e})=>e)}window.getNumberOfStay=function(e,t){let a=new Date(e),n=new Date(t),o=Math.abs(n.getTime()-a.getTime());return Math.ceil(o/864e5)},window.calculation=function(){let t=e("#roomPrice").val()||0,a=e("#roomQuantity").val()||0,n=e("#check_in_date").val()||0,o=e("#check_out_date").val()||0,i=getNumberOfStay(n,o);e("#ShowRoomPrice").text("$ "+parseInt(t).toFixed(2)),e("#ShowRoomQuantity").text(a.toString().padStart(2,"0")),e("#ShowNumberOfStay").text(i.toString().padStart(2,"0")),e("#numberOfStay").val(i),e("#ShowPrice").text("$ "+(t*i*a).toFixed(2))},window.handleSubmitCheckOut=function(){window.addEventListener("load",function(){let a=new Date,n=new Date(a);n.setDate(a.getDate()+1),e("#check_in_date").datepicker({format:"yyyy-mm-dd",startDate:a,autoclose:!0}).datepicker("setDate",a).on("changeDate",calculation),e("#check_out_date").datepicker({format:"yyyy-mm-dd",startDate:n,autoclose:!0}).datepicker("setDate",n).on("changeDate",calculation),calculation();let o=document.getElementsByClassName("needs-validation");Array.prototype.filter.call(o,function(a){a.addEventListener("change",calculation),a.addEventListener("submit",function(n){if(n.preventDefault(),n.stopPropagation(),!1===a.checkValidity()&&a.classList.add("was-validated"),!0===a.checkValidity()){n.preventDefault();let o=e(this).serializeArray(),i=o.reduce((e,t)=>(e[t.name]=t.value,e),{});e(".card-loading-overlay").addClass("d-block"),t("/checkout",{method:"POST",data:i}).then(({success:t,data:a})=>{if(t){let n=window.location.href,o=`${n}&tran_id=${a}`;window.location.href=o}else e(".card-loading-overlay").removeClass("d-block"),alert("Something went wrong.")}).catch(t=>{console.log(t),e(".card-loading-overlay").removeClass("d-block"),alert("Something went wrong.")})}},!1)})},!1)},window.handleAbaForm=function(){let a=new URLSearchParams(window.location.search),n=a.get("tran_id");n&&t(`/checkout/payment/${n}`).then(t=>{let{hashData:a,hash:n}=t,o=e("#aba_merchant_request");Object.keys(a).map(e=>o.append(`<input type='hidden' name='${e}' value='${a[e]}' />`)),o.append(`<input type='hidden' name='hash' value='${n}' />`),e("#invoice_name").text(t.name),e("#invoice_email").text(t.email),e("#invoice_hotel").text(t.branch.name),e("#invoice_room").text(t.room_type.name),e("#invoice_date_from").text(t.date_from),e("#invoice_date_to").text(t.date_to),e("#invoice_payment_option").text(t.payment_option),e("#invoice_price").text("$ "+parseInt(t.price).toFixed(2)),e("#invoice_req_time").val(t.req_time),e("#invoice_tran_id").val(t.tran_id),localStorage.setItem("hashData",JSON.stringify(a))}).catch(console.log)},window.handlePaymentStatus=function(){let a=()=>{setTimeout(()=>{let n=e("#invoice_tran_id").val(),o=e("#invoice_req_time").val();t("/checkout/payment/status",{method:"post",data:{tran_id:n,req_time:o}}).then(e=>{if("approved"===e.description){handleSendReceipt(n);var t=window.location.href+"&status=approved";window.location.href=t}else a()}).catch(console.log)},5e3)};a()},window.handleSendReceipt=function(e){t(`/checkout/payment/receipt/${e}`,{method:"post"})},window.handleStatusApprovedScreen=function(){let a=localStorage.getItem("hashData"),n=new URLSearchParams(window.location.search),o=n.get("status");if(a&&"approved"===o){let{tran_id:i,req_time:c}=JSON.parse(a);t("/checkout/payment/status",{method:"post",data:{tran_id:i,req_time:c}}).then(({payment_status:t})=>{"APPROVED"===t?console.log("Sending email"):(e(".completed-animation").empty(),e(".completed-animation").html(`
                <div class='alert alert-danger'>
                    <strong>Ooop!</strong><span class='ml-2'>We are sorry, something went wrong!</span>
                    <h5 class='small'>Please contact us.</h5>
                </div>
                `))}).catch(console.log)}}}(jQuery);